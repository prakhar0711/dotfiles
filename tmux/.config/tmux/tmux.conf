### ──────────────────────────────
### 🖥️ Terminal & Appearance
### ──────────────────────────────

# Truecolor and terminal capabilities
set -a terminal-features "tmux-256color:RGB"
set-option -g default-terminal "xterm-256color"
set-option -ga terminal-overrides ',*:Tc'

# Block cursor style (WezTerm compatible)
set -as terminal-overrides ',xterm*:Ss=\E[%p1%d q:Se=\E[2 q'

# Mouse support & fast escape
set -g mouse on
set -s escape-time 0

# Status bar layout
set -g status-position top
set -g status-justify centre
set -g status-bg "#18191a"
set -g status-fg "#a1b3b9"
set -g status-style "bg=default"

# Prefix highlight colors
set -g @prefix_highlight_fg '#a1b3b9' # default is 'colour231'
set -g @prefix_highlight_bg '#18191a'  # default is 'colour04'
set -g @prefix_highlight_show_copy_mode 'on'
set -g @prefix_highlight_copy_mode_attr 'fg=black,bg=yellow,bold' 
set -g @prefix_highlight_show_sync_mode 'on'
set -g @prefix_highlight_sync_mode_attr 'fg=black,bg=green' 

# Window title styles
set -g window-status-format '#[fg=grey,dim]#I:#W'
set -g window-status-current-format '#[bold]#[fg=blue]#I:#W*#[default]'
set -g window-status-current-style "fg=blue,bold"

# Status line content
set -g status-left ""
set -g status-right "#{prefix_highlight}"


### ──────────────────────────────
### 🎛️ Prefix & Config Reload
### ──────────────────────────────

# Change prefix to Ctrl-d
unbind C-b
set-option -g prefix C-d
bind-key C-d send-prefix

# Reload config (Prefix + r)
bind r source-file ~/.config/tmux/tmux.conf \; display-message "Config reloaded!"

### ──────────────────────────────
### 🪟 Navigation & Window Management
### ──────────────────────────────

# Indexing starts at 1
set -g base-index 1
set -g pane-base-index 1
set -g renumber-windows on

# Vi-style keybindings in copy mode
setw -g mode-keys vi

# Quick window switching
bind-key -r h select-window -t :-
bind-key -r l select-window -t :+
bind -r ^ last-window

# Split panes
bind -r "'" split-window -h
bind -r "]" split-window -v

# Launch sessionizer (Prefix + f)
bind-key -r f run-shell "tmux neww ~/.local/scripts/tmux-sessionizer"


### ──────────────────────────────
### 📋 Copy Mode (Vim Style)
### ──────────────────────────────

# Enter copy mode (Prefix + v)
unbind v
bind v copy-mode

# Inside copy mode (vi keys)
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi y send -X copy-selection

# Avoid mouse drag conflicts
unbind -T copy-mode-vi MouseDragEnd1Pane


### ──────────────────────────────
### 🔌 Plugins (TPM)
### ──────────────────────────────

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'sainnhe/tmux-fzf'          # Prefix + F
set -g @plugin 'jaclu/tmux-menus'          # Prefix + \
set -g @plugin 'alexwforsythe/tmux-which-key'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
# Initialize TPM (keep last)
run '~/.tmux/plugins/tpm/tpm'

