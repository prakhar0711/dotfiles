### ──────────────────────────────
### Terminal and Appearance Setup
### ──────────────────────────────

# Truecolor support
set -a terminal-features "tmux-256color:RGB"

# Default terminal (WezTerm compatible)
set-option -g default-terminal "xterm-256color"

# Block cursor style
set -as terminal-overrides ',xterm*:Ss=\E[%p1%d q:Se=\E[2 q'

# Truecolor overrides
set-option -ga terminal-overrides ',*:Tc'

# Mouse support and faster response
set -g mouse on
set -s escape-time 0

# Status bar appearance
set -g status-position top
set -g status-justify centre
set -g status-bg "#18191a"
set -g status-fg "#a1b3b9"
set -g status-style "bg=default"

# Window status styles
set -g window-status-format '#[fg=grey,dim]#I:#W'
set -g window-status-current-format '#[bold]#[fg=blue]#I:#W*#[default]'
set -g window-status-current-style "fg=blue bold"

# Status content
set -g status-left ""
set -g status-right ""

### ──────────────────────────────
### Prefix and Reload Bindings
### ──────────────────────────────

# Change prefix from Ctrl-b to Ctrl-d
unbind C-b
set-option -g prefix C-d
bind-key C-d send-prefix

# Reload config with prefix + r
bind r source-file ~/.config/tmux/tmux.conf \; display-message "Config reloaded!"

### ──────────────────────────────
### Navigation and Window Management
### ──────────────────────────────

# Window/pane indexing starts at 1
set -g base-index 1
set -g pane-base-index 1
set -g renumber-windows on

# Vi-style keys in copy mode
setw -g mode-keys vi

# Quick window switching
bind-key -r h select-window -t :-
bind-key -r l select-window -t :+
bind -r ^ last-window

# Splits
bind -r "'" split-window -h
bind -r "]" split-window -v

# Sessionizer (prefix + f)
bind-key -r f run-shell "tmux neww ~/.local/scripts/tmux-sessionizer"

### ──────────────────────────────
### Copy Mode (Vim Style)
### ──────────────────────────────

# Enter copy mode with v
unbind v
bind v copy-mode

# Inside copy mode
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi y send -X copy-selection

# Avoid mouse drag interfering with selection
unbind -T copy-mode-vi MouseDragEnd1Pane

### ──────────────────────────────
### Plugins
### ──────────────────────────────

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'sainnhe/tmux-fzf'          # Prefix + F
set -g @plugin 'jaclu/tmux-menus'          # Prefix + \
set -g @plugin 'alexwforsythe/tmux-which-key'
# set -g @plugin 'rose-pine/tmux'
set -g @rose_pine_variant 'main'           # Options: main, moon, dawn

# Initialize TPM (keep at end)
run '~/.tmux/plugins/tpm/tpm'

